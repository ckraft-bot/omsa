---
title: "Homework_6"
author: "Claire Kraft"
date: "2024-10-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
I DID NOT SUBMIT THIS HOMEWORK AS I DID NOT COMPLETE THE ASSIGNMENT. COMMITING THIS TO THE REPO FOR MIDTERM EXAM REVIEW PURPROSES. THE CODE RESULTS AND INTERPEATIONS ARE AFTER THE 2024-10-03 THURSDAY TA SESSION.

## Question 9.1
**Using the same crime data set uscrime.txt as in Question 8.2, apply Principal Component Analysis and then create a regression model using the first few principal components. Specify your new model in terms of the original variables (not the principal components), and compare its quality to that of your solution to Question 8.2. You can use the R function prcomp for PCA. (Note that to first scale the data, you can include scale. = TRUE to scale as part of the PCA function. Don’t forget that, to make a prediction for the new city, you’ll need to unscale the coefficients (i.e., do the scaling calculation in reverse)!)**



```{r set up}
# Set Up
rm(list = ls())

# Helper 
# Install.packages("GGally") # https://ggobi.github.io/ggally/
library(GGally)
# Install.packages('corrplot') # https://www.rdocumentation.org/packages/corrplot/versions/0.94
library(corrplot)
library(DAAG)
library(stats)

# Read In Data 
uscrime <- read.table("~/GitHub/omsa/ISYE 6501/Homework 06/uscrime.txt", stringsAsFactors = FALSE, header = TRUE)
head(uscrime)
```


```{r EDA}
# Draw Correlations
# Look At Reference 1
crime_data <- cor(uscrime)
corrplot(crime_data, method = "circle", order = 'AOE')

# Examine Some Of The Strongest Correlations - 
# Look At Reference 2
# ggpairs(uscrime, columns = c("Ed", "Ineq", "Po1")) # Choosing These Parameters Based On My Hw 5 Results
ggpairs(crime_data, columns = c('Crime', 'Po1', 'Po2', 'Ed', 'NW', 'Wealth', 'Ineq'))
ggpairs
```

```{r PCA}
# PCA
PCA = prcomp(uscrime[,1:15], scale. = TRUE)
summary(PCA)

# Eigenvector Matrix
PCA$rotation  

# Use the first 4 PCs
screeplot(PCA, type = "lines", col = "blue")
```

```{r variances}
# Calculate Variances and Proportion of Variances

# Eigenvector Matrix
PCA$rotation  

screeplot(PCA, type = "lines", col = "blue")
```


References:

[1] Wei, T., & Simko, V. (2021, November 18). An Introduction to corrplot Package. Cran.r-Project.org. https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html 

[2] APA citation

[3] APA citation

[4] APA citation

[5] APA citation
