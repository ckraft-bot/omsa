---
title: "Homework_6"
author: "Claire Kraft"
date: "2024-10-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
I DID NOT SUBMIT THIS HOMEWORK AS I DID NOT COMPLETE THE ASSIGNMENT. COMMITING THIS TO THE REPO FOR MIDTERM EXAM REVIEW PURPROSES. THE CODE RESULTS AND INTERPEATIONS ARE AFTER THE 2024-10-03 THURSDAY TA SESSION.

## Question 9.1
**Using the same crime data set uscrime.txt as in Question 8.2, apply Principal Component Analysis and then create a regression model using the first few principal components. Specify your new model in terms of the original variables (not the principal components), and compare its quality to that of your solution to Question 8.2. You can use the R function prcomp for PCA. (Note that to first scale the data, you can include scale. = TRUE to scale as part of the PCA function. Don’t forget that, to make a prediction for the new city, you’ll need to unscale the coefficients (i.e., do the scaling calculation in reverse)!)**

Conclusion: The TA's conclusion is that, PCA, in this case, didn't really help us build a better linear regression model as it didn't give us any stronger prediction power compared to the pre PCA model. My understanding is that the PCA's goal is to reduce dimension or sift through noise by simply pulling out the most impact features/independent variables.


```{r set up}
# Set up
rm(list = ls())

# Helper 
# Install.packages("GGally") # https://ggobi.github.io/ggally/
library(GGally)
# Install.packages('corrplot') # https://www.rdocumentation.org/packages/corrplot/versions/0.94
library(corrplot)
library(DAAG)
library(stats)

# Read in data
uscrime <- read.table("~/GitHub/omsa/ISYE 6501/Homework 06/uscrime.txt", stringsAsFactors = FALSE, header = TRUE)
head(uscrime)
```

EDA of the data to find the strongest correlations
```{r EDA}
# Draw correlations
# Look at reference 1
crime_data <- cor(uscrime)
corrplot(crime_data, method = "circle", order = 'AOE')

# Examine some of the strongest correlations- 
# Look at reference 2
# ggpairs(uscrime, columns = c("Ed", "Ineq", "Po1")) # Choosing These Parameters Based On My Hw 5 Results
ggpairs(crime_data, columns = c('Crime', 'Po1', 'Po2', 'Ed', 'NW', 'Wealth', 'Ineq'))
ggpairs
```

Performing PCA, summarizing the results, extracting the eigenvectors, and visualizing the variance explained by each principal component in a scree plot.
```{r PCA}
# PCA
PCA = prcomp(uscrime[,1:15], scale. = TRUE)
summary(PCA)

# Eigenvector Matrix
PCA$rotation  

# Use the first 4 PCs
screeplot(PCA, type = "lines", col = "blue")
```

Variance is the square of stdev
```{r variances}
# Calculate variances and proportion of variances
variance <- PCA$sdev^2 
variance

# Plot the proportion of variances from PCA
propvvariance <- variance / sum(variance)
propvvariance
plot(propvvariance, xlab = 'Principal Component', ylab = 'Proportion of Variances Explained')

# Plot the cumulative sum proportion of variances from PCA
cumsum_propvvariance <- cumsum(propvvariance)
cumsum_propvvariance
plot(cumsum_propvvariance, xlab = 'Principal Component', ylab = 'Cumulative Proportion of Variances')
```

PCA using prcomp
```{r prcomp}
## all from the TA
# Get the documentation on the `prcomp` function.
?prcomp

# Select the first 4 principal components from the transformed data matrix `PCA$x` and assign to `pcs`.
pcs <- PCA$x[,1:4] 

# Display the attributes of the `PCA$x` object, which contains the transformed data.
attributes(PCA$x)

# Print the `pcs` object, which contains the first 4 principal components of the transformed data.
pcs

# Compute and display the covariance matrix of the transformed data `PCA$x`.
cov(PCA$x)

# Create a diagonal matrix from the variances (which are the squares of the standard deviations) of the principal components.
diag(PCA$sdev^2)

# Print the transformed data matrix `PCA$x`.
PCA$x

# Print the `pcs` object again, which contains the first 4 principal components of the transformed data.
pcs

# Calculate the correlation matrix of the transformed data `PCA$x`.
correlation <- cor(PCA$x)

# Print the correlation matrix.
correlation

# Plot the correlation matrix using the `corrplot` package.
corrplot(correlation)
```

Build a regression on the first 4 PCs
```{r regression}


```

References:

[1] Wei, T., & Simko, V. (2021, November 18). An Introduction to corrplot Package. Cran.r-Project.org. https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html 

[2] TA office hour